if(document.readyState!=="loading"){ISCready()}else{document.addEventListener("DOMContentLoaded",ISCready)}const ISC_Z_INDEX=isc_front_data.z_index||"9999";const ISC_CAPTION_HORIZONTAL_MARGIN=isc_front_data.caption_horizontal_margin||5;const ISC_CAPTION_VERTICAL_MARGIN=isc_front_data.caption_vertical_margin||5;const ISC_STYLE_STRING=(()=>{const styles=isc_front_data.caption_style||{};let styleString="";for(const[property,value]of Object.entries(styles)){styleString+=`${property}: ${value}; `}return styleString.trim()})();function ISCready(){setTimeout(function(){const captions=document.querySelectorAll(".isc-source .isc-source-text");const l=captions.length;for(let i=0;i<l;i++){isc_update_caption_style(captions[i]);isc_update_caption_position(captions[i].parentNode)}},100);window.addEventListener("load",function(){setTimeout(function(){isc_update_captions_positions()},100)});window.addEventListener("resize",function(){isc_update_captions_positions()});isc_setup_mutation_observer()}function isc_update_captions_styles(){const captions=document.querySelectorAll(".isc-source .isc-source-text");const l=captions.length;for(let i=0;i<l;i++){isc_update_caption_style(captions[i])}}function isc_update_caption_style(caption){if(caption.hasAttribute("style")){return}caption.setAttribute("style",ISC_STYLE_STRING);caption.style.paddingBottom=window.getComputedStyle(caption)["padding-top"]}function isc_update_captions_positions(){const captions=document.querySelectorAll(".isc-source");const l=captions.length;for(let i=0;i<l;i++){isc_update_caption_position(captions[i])}}function isc_update_caption_position(el){const caption=el.querySelector(".isc-source-text");if(!caption){return}caption.style.position="absolute";caption.style.left="0";caption.style.top="0";let att=el.querySelector("img");let is_fallback=false;if(!att){att=el;is_fallback=true}const attw=att instanceof HTMLImageElement?att.width:att.offsetWidth;const atth=att instanceof HTMLImageElement?att.height:att.offsetHeight;const l=!is_fallback?att.offsetLeft:0;const t=!is_fallback?att.offsetTop:0;const tw=ISCouterWidth(caption);const th=ISCouterHeight(caption);const attpl=!is_fallback?parseInt(window.getComputedStyle(att)["padding-left"].substring(0,window.getComputedStyle(att)["padding-left"].indexOf("px"))):0;const attpt=!is_fallback?parseInt(window.getComputedStyle(att)["padding-top"].substring(0,window.getComputedStyle(att)["padding-top"].indexOf("px"))):0;const attml=!is_fallback?parseInt(window.getComputedStyle(att)["margin-left"].substring(0,window.getComputedStyle(att)["margin-left"].indexOf("px"))):0;const attmt=!is_fallback?parseInt(window.getComputedStyle(att)["margin-top"].substring(0,window.getComputedStyle(att)["margin-top"].indexOf("px"))):0;const tml=ISC_CAPTION_HORIZONTAL_MARGIN;const tmt=ISC_CAPTION_VERTICAL_MARGIN;const pos=isc_front_data.caption_position;let posl=0;let post=0;switch(pos){case"top-left":posl=l+attpl+attml+tml;post=t+attpt+attmt+tmt;break;case"top-center":posl=l+(Math.round(attw/2)-Math.round(tw/2))+attpl+attml;post=t+attpt+attmt+tmt;break;case"top-right":posl=l-attpl+attml-tml+attw-tw;post=t+attpt+attmt+tmt;break;case"center":posl=l+(Math.round(attw/2)-Math.round(tw/2))+attpl+attml;post=t+(Math.round(atth/2)-Math.round(th/2))+attpt+attmt;break;case"bottom-left":posl=l+attpl+attml+tml;post=t-attpt+attmt-tmt-th+atth;break;case"bottom-center":posl=l+(Math.round(attw/2)-Math.round(tw/2))+attpl+attml;post=t+attpt+attmt-tmt-th+atth;break;case"bottom-right":posl=l-attpl+attml-tml+attw-tw;post=t+attpt+attmt-tmt-th+atth;break}caption.style.left=posl+"px";caption.style.top=post+"px";caption.style.zIndex=ISC_Z_INDEX}function ISCouterWidth(el){el.style.width="auto";let style=getComputedStyle(el);const naturalWidth=el.getBoundingClientRect().width;const margins=parseInt(style.marginLeft)+parseInt(style.marginRight);el.dataset.naturalWidth=naturalWidth;return naturalWidth+margins}function ISCouterHeight(el){let style=getComputedStyle(el);return el.offsetHeight+parseInt(style.marginTop)+parseInt(style.marginBottom)}function isc_setup_mutation_observer(){const elementsToObserveSelectors=isc_front_data.observe_elements_selectors||[];if(elementsToObserveSelectors.length===0){return}const observer=new MutationObserver((mutationsList,observerInstance)=>{let newCaptionsDetected=false;for(const mutation of mutationsList){if(mutation.type==="childList"&&mutation.addedNodes.length>0){for(const addedNode of mutation.addedNodes){if(addedNode.nodeType===Node.ELEMENT_NODE){if(addedNode.querySelector(".isc-source .isc-source-text")){newCaptionsDetected=true;break}}}}if(newCaptionsDetected){break}}if(newCaptionsDetected){console.log("ISC MutationObserver: New captions detected. Updating styles and positions.");isc_update_captions_styles();isc_update_captions_positions()}});elementsToObserveSelectors.forEach(selector=>{const targetNode=document.querySelector(selector);if(targetNode){observer.observe(targetNode,{childList:true,subtree:true})}})}